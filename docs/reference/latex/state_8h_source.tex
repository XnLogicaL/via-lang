\doxysection{state.\+h}
\hypertarget{state_8h_source}{}\label{state_8h_source}\index{src/interpreter/state.h@{src/interpreter/state.h}}
\mbox{\hyperlink{state_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ a\ part\ of\ the\ via\ Programming\ Language\ project}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ Copyright\ (C)\ 2024-\/2025\ XnLogical\ -\/\ Licensed\ under\ GNU\ GPL\ v3.0}}
\DoxyCodeLine{00003\ }
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#ifndef\ VIA\_HAS\_HEADER\_STATE\_H}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#define\ VIA\_HAS\_HEADER\_STATE\_H}}
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <common.h>}}
\DoxyCodeLine{00017\ \textcolor{preprocessor}{\#include\ <context.h>}}
\DoxyCodeLine{00018\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{call-stack_8h}{call-\/stack.h}}"{}}}
\DoxyCodeLine{00019\ \textcolor{preprocessor}{\#include\ "{}\mbox{\hyperlink{instruction_8h}{instruction.h}}"{}}}
\DoxyCodeLine{00020\ \textcolor{preprocessor}{\#include\ "{}tvalue.h"{}}}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00027\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacevia}{via}}\ \{}
\DoxyCodeLine{00028\ }
\DoxyCodeLine{00033\ \textcolor{keyword}{inline}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacevia_a72a3c755471e881c73bd94ade4d5839e}{REGISTER\_COUNT}}\ =\ 65536;}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00039\ \textcolor{keyword}{inline}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacevia_a9f3c8100638fb61b095c359558bc7bd8}{REGISTER\_STACK\_COUNT}}\ =\ 256;}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00045\ \textcolor{keyword}{inline}\ \textcolor{keyword}{constexpr}\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{namespacevia_aa0a20b52d04392dad68c2230cd48b0c3}{REGISTER\_SPILL\_COUNT}}\ =\ \mbox{\hyperlink{namespacevia_a72a3c755471e881c73bd94ade4d5839e}{REGISTER\_COUNT}}\ -\/\ \mbox{\hyperlink{namespacevia_a9f3c8100638fb61b095c359558bc7bd8}{REGISTER\_STACK\_COUNT}};}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00051\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{structvia_1_1ErrorState}{ErrorState}}\ \{}
\DoxyCodeLine{00052\ \ \ \mbox{\hyperlink{structvia_1_1CallFrame}{CallFrame}}*\ \mbox{\hyperlink{structvia_1_1ErrorState_af09d96cbe31a2f6b72c8f9f60aa9a2aa}{frame}}\ =\ \textcolor{keyword}{nullptr};\ }
\DoxyCodeLine{00053\ \ \ std::string\ \mbox{\hyperlink{structvia_1_1ErrorState_adef414a171f8dbc8aee1bfb52eb9f124}{message}}\ =\ \textcolor{stringliteral}{"{}"{}};\ \ \ }
\DoxyCodeLine{00054\ \};}
\DoxyCodeLine{00055\ }
\DoxyCodeLine{00060\ \textcolor{keyword}{template}<const\ \textcolor{keywordtype}{size\_t}\ Size>}
\DoxyCodeLine{00061\ \textcolor{keyword}{struct\ }\textcolor{keyword}{alignas}(64)\ \mbox{\hyperlink{structvia_1_1RegisterHolder}{RegisterHolder}}\ \{}
\DoxyCodeLine{00062\ \ \ \mbox{\hyperlink{structvia_1_1Value}{Value}}\ registers[Size];}
\DoxyCodeLine{00063\ \};}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00066\ \textcolor{keyword}{using\ }\mbox{\hyperlink{structvia_1_1RegisterHolder}{StkRegHolder}}\ =\ \mbox{\hyperlink{structvia_1_1RegisterHolder}{RegisterHolder<REGISTER\_STACK\_COUNT>}};}
\DoxyCodeLine{00067\ }
\DoxyCodeLine{00069\ \textcolor{keyword}{using\ }\mbox{\hyperlink{structvia_1_1RegisterHolder}{HeapRegHolder}}\ =\ \mbox{\hyperlink{structvia_1_1RegisterHolder}{RegisterHolder<REGISTER\_SPILL\_COUNT>}};}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00079\ \textcolor{keyword}{struct\ }\textcolor{keyword}{alignas}(64)\ \mbox{\hyperlink{structvia_1_1State}{State}}\ \{}
\DoxyCodeLine{00080\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00081\ \ \ VIA\_NOCOPY(\mbox{\hyperlink{structvia_1_1State}{State}});}
\DoxyCodeLine{00082\ \ \ VIA\_NOMOVE(\mbox{\hyperlink{structvia_1_1State}{State}});}
\DoxyCodeLine{00083\ }
\DoxyCodeLine{00089\ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{structvia_1_1State}{State}}(\mbox{\hyperlink{structvia_1_1RegisterHolder}{StkRegHolder}}\&\ stack\_regs,\ \mbox{\hyperlink{classvia_1_1TransUnitContext}{TransUnitContext}}\&\ \mbox{\hyperlink{structvia_1_1State_a5d1d7c7a62afa0de44f4e49964f66152}{unit\_ctx}});}
\DoxyCodeLine{00090\ \ \ \mbox{\hyperlink{structvia_1_1State}{\string~State}}();}
\DoxyCodeLine{00091\ }
\DoxyCodeLine{00093\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a68d48cb315d46be083a872c56728a250}{execute}}();}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00096\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a2d079d02ce484fa69f0c563146f89383}{execute\_step}}(std::optional<Instruction>\ insn\ =\ std::nullopt);}
\DoxyCodeLine{00097\ }
\DoxyCodeLine{00099\ \ \ \mbox{\hyperlink{structvia_1_1Value}{Value}}\&\ \mbox{\hyperlink{structvia_1_1State_ae0da756ce5488bb557815be631d23e95}{get\_register}}(\mbox{\hyperlink{namespacevia_a90951ca238c08fe5449c13c9ed3cc38e}{operand\_t}}\ reg);}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00102\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a35f4055771617b549d18b2b3055a5565}{set\_register}}(\mbox{\hyperlink{namespacevia_a90951ca238c08fe5449c13c9ed3cc38e}{operand\_t}}\ reg,\ \mbox{\hyperlink{structvia_1_1Value}{Value}}\ value);}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00105\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a8a45bf94707cb30b0b9f67f48a278fca}{push\_nil}}();}
\DoxyCodeLine{00106\ }
\DoxyCodeLine{00108\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a6233ca75e8cd3ce034ec0b3d5950f974}{push\_int}}(\textcolor{keywordtype}{int}\ value);}
\DoxyCodeLine{00109\ }
\DoxyCodeLine{00111\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a26ce2600d847e6c8be732915c9213991}{push\_float}}(\textcolor{keywordtype}{float}\ value);}
\DoxyCodeLine{00112\ }
\DoxyCodeLine{00114\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a2608f3a09f5ffd338c7617384f71a6a4}{push\_true}}();}
\DoxyCodeLine{00115\ }
\DoxyCodeLine{00117\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_afd335db2b880c527266d109fdb3bc232}{push\_false}}();}
\DoxyCodeLine{00118\ }
\DoxyCodeLine{00120\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a9bf9e2df593f981b2d3043154b74c274}{push\_string}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ str);}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00123\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a2b8c32ab796ca6205af1442e9b0399cc}{push\_array}}();}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00126\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a516b171b140af835419f1c80214fa082}{push\_dict}}();}
\DoxyCodeLine{00127\ }
\DoxyCodeLine{00129\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a283868e76335bbd137696faca1927ede}{push}}(\mbox{\hyperlink{structvia_1_1Value}{Value}}\ value);}
\DoxyCodeLine{00130\ }
\DoxyCodeLine{00132\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_af3f224a307724ffaa26b1fc848c6a2c0}{drop}}();}
\DoxyCodeLine{00133\ }
\DoxyCodeLine{00135\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a01471c2328b8d5a96e8a1e0e0638a19b}{set\_local}}(\textcolor{keywordtype}{size\_t}\ position,\ \mbox{\hyperlink{structvia_1_1Value}{Value}}\ value);}
\DoxyCodeLine{00136\ }
\DoxyCodeLine{00138\ \ \ \mbox{\hyperlink{structvia_1_1Value}{Value}}\&\ \mbox{\hyperlink{structvia_1_1State_a40bbb562770686a36d25f6dbc9737ed4}{get\_local}}(\textcolor{keywordtype}{size\_t}\ position);}
\DoxyCodeLine{00139\ }
\DoxyCodeLine{00141\ \ \ \mbox{\hyperlink{structvia_1_1Value}{Value}}\&\ \mbox{\hyperlink{structvia_1_1State_acf934b61922d564833e6a0eae5c0236e}{get\_argument}}(\textcolor{keywordtype}{size\_t}\ offset);}
\DoxyCodeLine{00142\ }
\DoxyCodeLine{00144\ \ \ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{structvia_1_1State_a72abbce72a8c216adcb99a1bb8a90ae4}{stack\_size}}();}
\DoxyCodeLine{00145\ }
\DoxyCodeLine{00147\ \ \ \mbox{\hyperlink{structvia_1_1Value}{Value}}\&\ \mbox{\hyperlink{structvia_1_1State_a41bc340c01119ceab9cecb91d63f77c7}{get\_global}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name);}
\DoxyCodeLine{00148\ }
\DoxyCodeLine{00150\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_ab4bb7a801045f5c34e993ed85fd5d95e}{set\_global}}(\textcolor{keyword}{const}\ \textcolor{keywordtype}{char}*\ name,\ \textcolor{keyword}{const}\ \mbox{\hyperlink{structvia_1_1Value}{Value}}\&\ value);}
\DoxyCodeLine{00151\ }
\DoxyCodeLine{00153\ \ \ \textcolor{keywordtype}{void}\ \mbox{\hyperlink{structvia_1_1State_a0247e4df4f8370943e472e164e38fb42}{call}}(\textcolor{keyword}{const}\ \mbox{\hyperlink{structvia_1_1Closure}{Closure}}\&\ callee,\ \textcolor{keywordtype}{size\_t}\ argc);}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00156\ \ \ \mbox{\hyperlink{structvia_1_1Instruction}{Instruction}}*\ \mbox{\hyperlink{structvia_1_1State_a81bd8e971d3cc2ee8de0f91455ef0a76}{pc}}\ =\ \textcolor{keyword}{nullptr};\ \ \ \ \ \ }
\DoxyCodeLine{00157\ \ \ \mbox{\hyperlink{structvia_1_1Instruction}{Instruction}}**\ \mbox{\hyperlink{structvia_1_1State_ab19a2e0fec0a69aa3cd45094afe2055b}{labels}};\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00158\ \ \ \mbox{\hyperlink{structvia_1_1Dict}{Dict}}*\ \mbox{\hyperlink{structvia_1_1State_a2f2ec338bd909545738e9765fbbcf81b}{globals}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00159\ \ \ \mbox{\hyperlink{structvia_1_1CallStack}{CallStack}}*\ \mbox{\hyperlink{structvia_1_1State_a867bbeaf5f8f95597662d97b3d7c8b46}{callstack}};\ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00160\ \ \ \mbox{\hyperlink{structvia_1_1ErrorState}{ErrorState}}*\ \mbox{\hyperlink{structvia_1_1State_a0ab5252a2dfb3e0fc507ecc053e86436}{err}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00161\ \ \ \mbox{\hyperlink{structvia_1_1Value}{Value}}\ \mbox{\hyperlink{structvia_1_1State_a1684cdb01028aa5c417e201dec8e9ab7}{main}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00162\ \ \ register\_t\ \mbox{\hyperlink{structvia_1_1State_a6684dd3a8a6ec87f408b33edb0f89345}{ret}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00163\ \ \ register\_t\ \mbox{\hyperlink{structvia_1_1State_a32f49386f9e16d0b41dc1f7e3a726764}{args}};\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ }
\DoxyCodeLine{00164\ \ \ \mbox{\hyperlink{structvia_1_1RegisterHolder}{StkRegHolder}}\&\ \mbox{\hyperlink{structvia_1_1State_acdae6236fd92b4d5954fbef758937c8d}{stack\_registers}};\ \ }
\DoxyCodeLine{00165\ \ \ \mbox{\hyperlink{structvia_1_1RegisterHolder}{HeapRegHolder}}*\ \mbox{\hyperlink{structvia_1_1State_a144b1e6643e0c2f2e2ed8969edf288c0}{spill\_registers}};\ }
\DoxyCodeLine{00166\ \ \ \mbox{\hyperlink{classvia_1_1TransUnitContext}{TransUnitContext}}\&\ \mbox{\hyperlink{structvia_1_1State_a5d1d7c7a62afa0de44f4e49964f66152}{unit\_ctx}};\ \ \ \ \ }
\DoxyCodeLine{00167\ \};}
\DoxyCodeLine{00168\ }
\DoxyCodeLine{00169\ \}\ \textcolor{comment}{//\ namespace\ via}}
\DoxyCodeLine{00170\ }
\DoxyCodeLine{00173\ \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
